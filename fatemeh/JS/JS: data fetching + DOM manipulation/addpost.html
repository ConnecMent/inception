<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="addpoststyle.css" />
  </head>
  <body>
    <div class="newPost">
      <form name="newPost" method="post">
        Title:<br />
        <input class="Title" type="text" name="title" /><br />
        Author (ID):<br />
        <input class="Author" type="text" name="author" /> <br />
        Description:<br />
        <textarea class="PostBody" type="text" name="postbody"></textarea>
      </form>
      <div class="buttons">
        <button class="addPost" onclick="addNewPost()">+ Add Post</button>
        <button class="CancelB" onclick="goBack()">Cancel</button>
      </div>
    </div>
    <script>
      function addNewPost() {
        document.getElementsByClassName("addPost")[0].innerHTML = "Pending...";

        let newTitle = document.forms["newPost"]["title"].value;
        let newAuthor = parseInt(document.forms["newPost"]["author"].value);
        let newBody = document.forms["newPost"]["postbody"].value;

        fetch("https://jsonplaceholder.typicode.com/posts", {
          method: "POST",
          body: JSON.stringify({
            title: newTitle,
            body: newBody,
            userId: newAuthor,
          }),
          headers: {
            "Content-type": "application/json; charset=UTF-8",
          },
        })
          .then((response) => response.json())
          .then((json) => Done());
      }
      function Done() {
        document.getElementsByClassName("addPost")[0].innerHTML = "Done!";
        location.replace("./index.html");
      }
      function goBack() {
        if (confirm("Are you sure?")) location.replace("./index.html");
      }
    </script>
  </body>
</html>
